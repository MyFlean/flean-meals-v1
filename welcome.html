<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#f8f7f4">
  <title>Welcome to Flean</title>
  <link rel="stylesheet" href="assets/styles.css">
  <style>
    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       PREMIUM ONBOARDING STYLES
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    
    body {
      background: #f8f7f4; /* Premium Off-White / Pearl */
      overflow: hidden;
      font-family: 'Montserrat', sans-serif;
    }

    .onboarding-container {
      width: 100vw;
      height: 100vh;
      height: 100dvh; /* Better mobile support */
      position: relative;
      background: radial-gradient(circle at 50% 0%, #ffffff 0%, #f8f7f4 100%);
    }

    .screen {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      transition: opacity 0.8s cubic-bezier(0.2, 0.8, 0.2, 1), transform 0.8s cubic-bezier(0.2, 0.8, 0.2, 1);
      opacity: 0;
      pointer-events: none;
      z-index: 1;
    }

    .screen.active {
      opacity: 1;
      pointer-events: all;
      z-index: 2;
      transform: scale(1);
    }

    .screen.exit {
      opacity: 0;
      transform: scale(0.95) translateY(-10px);
      pointer-events: none;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SCREEN 1: THE STIMULUS (HERO)
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .hero-image-container {
      height: 55%; /* Reduced from 65% to give more room for text */
      width: 100%;
      overflow: hidden;
      position: relative;
      border-bottom-left-radius: 40px;
      border-bottom-right-radius: 40px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.08);
      z-index: 10;
      flex-shrink: 0;
    }

    .hero-image {
      width: 100%;
      height: 100%;
      object-fit: cover;
      object-position: center;
      opacity: 0;
      transform: scale(1.1);
      animation: hero-reveal 1.4s cubic-bezier(0.2, 0.8, 0.2, 1) forwards;
    }

    @keyframes hero-reveal {
      to { opacity: 1; transform: scale(1); }
    }

    .screen-1-content {
      flex: 1;
      padding: var(--space-xl) var(--space-lg);
      padding-bottom: calc(var(--space-xl) + env(safe-area-inset-bottom));
      display: flex;
      flex-direction: column;
      justify-content: center;
      text-align: center;
      min-height: 0; /* Allow flex shrinking */
    }

    .brand-pill {
      display: inline-block;
      margin: 0 auto var(--space-md);
      padding: 6px 16px;
      background: #e6f4f1;
      color: #047857;
      border-radius: 999px;
      font-size: 0.75rem;
      font-weight: 700;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      opacity: 0;
      animation: fade-up 0.8s ease-out 0.4s forwards;
    }

    .main-heading {
      font-family: 'Playfair Display', serif;
      font-size: 3rem;
      font-weight: 700;
      color: var(--charcoal);
      line-height: 1.1;
      margin-bottom: var(--space-sm);
      letter-spacing: -0.02em;
      opacity: 0;
      animation: fade-up 0.8s ease-out 0.6s forwards;
    }

    .sub-heading {
      font-size: 1rem;
      color: var(--slate-500);
      font-weight: 500;
      margin-bottom: var(--space-xl);
      line-height: 1.5;
      opacity: 0;
      animation: fade-up 0.8s ease-out 0.7s forwards;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SCREEN 1.5: TRUST & PURITY (VC BAIT)
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .screen-trust-content {
      height: 100%;
      display: flex;
      flex-direction: column;
      justify-content: center;
      padding: 0 32px;
      text-align: center;
      background: linear-gradient(135deg, #fdfbf7 0%, #fff 100%);
    }

    .trust-badge-container {
      margin: 0 auto 40px;
      position: relative;
      width: 120px;
      height: 120px;
    }

    .trust-shield {
      width: 100%;
      height: 100%;
      background: var(--deep-green);
      mask: url('data:image/svg+xml;utf8,<svg viewBox="0 0 24 24" fill="black" xmlns="http://www.w3.org/2000/svg"><path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4z"/></svg>') no-repeat center;
      mask-size: contain;
      -webkit-mask: url('data:image/svg+xml;utf8,<svg viewBox="0 0 24 24" fill="black" xmlns="http://www.w3.org/2000/svg"><path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4z"/></svg>') no-repeat center;
      -webkit-mask-size: contain;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transform: scale(0.5);
      animation: shield-pop 0.8s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
    }

    .trust-number {
      font-family: 'Playfair Display', serif;
      font-size: 2.5rem;
      font-weight: 800;
      color: white;
      line-height: 1;
      display: block;
      margin-top: 8px;
    }
    
    .trust-number span {
      font-size: 1rem;
      font-weight: 600;
      display: block;
      margin-top: -4px;
      font-family: 'Montserrat', sans-serif;
      text-transform: uppercase;
      letter-spacing: 0.1em;
    }

    @keyframes shield-pop {
      to { opacity: 1; transform: scale(1); }
    }

    .trust-heading {
      font-family: 'Playfair Display', serif;
      font-size: 2.5rem;
      font-weight: 700;
      color: var(--charcoal);
      margin-bottom: 24px;
      opacity: 0;
      animation: fade-up 0.8s ease-out 0.3s forwards;
    }

    .trust-highlight {
      color: #b91c1c;
      position: relative;
      display: inline-block;
    }
    
    .trust-highlight::after {
      content: '';
      position: absolute;
      bottom: 4px;
      left: 0;
      width: 100%;
      height: 8px;
      background: rgba(185, 28, 28, 0.1);
      z-index: -1;
    }

    .trust-copy {
      font-size: 1.1rem;
      color: var(--slate-600);
      line-height: 1.6;
      margin-bottom: 40px;
      opacity: 0;
      animation: fade-up 0.8s ease-out 0.5s forwards;
    }

    .banned-list {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 12px;
      margin-bottom: 48px;
      opacity: 0;
      animation: fade-up 0.8s ease-out 0.7s forwards;
    }

    .banned-pill {
      padding: 8px 16px;
      background: #fee2e2;
      color: #991b1b;
      border-radius: 999px;
      font-size: 0.85rem;
      font-weight: 700;
      text-decoration: line-through;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SCREEN 2: THE ENGAGEMENT (SELECTOR)
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .screen-2-content {
      height: 100%;
      display: flex;
      flex-direction: column;
      max-width: 600px;
      margin: 0 auto;
      position: relative;
      overflow: hidden;
    }

    .scroll-wrapper {
      flex: 1;
      overflow-y: auto;
      padding: var(--space-2xl) var(--space-lg) 140px; /* Extra padding for footer */
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none; /* Firefox */
    }
    
    .scroll-wrapper::-webkit-scrollbar {
      display: none; /* Chrome/Safari */
    }

    .selector-header {
      margin-bottom: var(--space-xl);
      text-align: center;
    }

    .selector-heading {
      font-family: 'Playfair Display', serif;
      font-size: 2.25rem;
      font-weight: 700;
      color: var(--charcoal);
      margin-bottom: 0.5rem;
    }

    .selector-sub {
      color: var(--slate-500);
      font-size: 0.95rem;
    }

    .chip-section {
      margin-bottom: var(--space-xl);
    }

    .chip-section-title {
      font-size: 0.75rem;
      font-weight: 700;
      color: var(--slate-400);
      text-transform: uppercase;
      letter-spacing: 0.15em;
      margin-bottom: var(--space-md);
      padding-left: 4px;
    }

    .chip-grid {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }

    /* Premium Chip Design */
    .chip {
      position: relative;
      padding: 12px 20px;
      background: white;
      border: 1px solid #e2e8f0;
      border-radius: 16px;
      font-size: 0.95rem;
      font-weight: 600;
      color: var(--slate-700);
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.2, 0.8, 0.2, 1);
      box-shadow: 0 2px 4px rgba(0,0,0,0.02);
      display: flex;
      align-items: center;
      gap: 8px;
      user-select: none;
      -webkit-tap-highlight-color: transparent;
    }

    .chip:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 16px rgba(0,0,0,0.06);
      border-color: #cbd5e1;
    }

    .chip:active {
      transform: scale(0.96);
    }

    /* Selected State - Unified Elegant Look */
    .chip.selected {
      background: var(--emerald-800);
      border-color: var(--emerald-800);
      color: white;
      box-shadow: 0 8px 20px rgba(6, 78, 59, 0.25);
      padding-right: 16px;
    }

    .chip-icon {
      font-size: 1.1rem;
    }

    .chip-check {
      width: 0;
      height: 16px;
      overflow: hidden;
      opacity: 0;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
    }

    .chip.selected .chip-check {
      width: 16px;
      opacity: 1;
      margin-left: 4px;
    }

    /* Footer Area */
    .selector-footer {
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      padding: var(--space-lg);
      background: rgba(248, 247, 244, 0.95);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border-top: 1px solid rgba(0,0,0,0.05);
      z-index: 20;
    }

    .selection-status {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: var(--space-md);
      font-size: 0.9rem;
      font-weight: 600;
      color: var(--slate-500);
    }

    .status-count.active {
      color: var(--emerald-600);
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SCREEN 3: PERSONALIZATION (PROCESSING)
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .screen-3-content {
      height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: var(--space-xl);
    }

    /* Radial Animation - RESTORED */
    .radial-container {
      position: relative;
      width: 240px;
      height: 240px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: var(--space-2xl);
    }

    .radial-circle {
      position: absolute;
      border-radius: 50%;
      mix-blend-mode: multiply;
      filter: blur(8px);
      opacity: 0.8;
      animation: rotate-orbit 4s linear infinite;
    }

    .radial-1 {
      width: 100px;
      height: 100px;
      background: #60a5fa; /* Blue */
      top: 20px;
      left: 70px;
      animation-duration: 3s;
    }

    .radial-2 {
      width: 120px;
      height: 120px;
      background: #34d399; /* Green */
      bottom: 30px;
      right: 40px;
      animation-duration: 5s;
      animation-direction: reverse;
    }

    .radial-3 {
      width: 90px;
      height: 90px;
      background: #fb7185; /* Red */
      bottom: 40px;
      left: 40px;
      animation-duration: 4s;
    }
    
    .radial-center {
      width: 160px;
      height: 160px;
      background: white;
      border-radius: 50%;
      z-index: 10;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 0 40px rgba(0,0,0,0.05);
      position: relative;
      border: none;
    }
    
    .radial-spinner {
      width: 40px;
      height: 40px;
      border: 3px solid #f1f5f9;
      border-top-color: var(--emerald-600);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes rotate-orbit {
      from { transform: rotate(0deg) translateX(20px) rotate(0deg); }
      to { transform: rotate(360deg) translateX(20px) rotate(-360deg); }
    }
    
    .processing-logo {
      font-size: 3rem;
      animation: pulse 2s infinite ease-in-out;
    }

    @keyframes pulse {
      0% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.15); opacity: 0.8; }
      100% { transform: scale(1); opacity: 1; }
    }

    .processing-text {
      font-family: 'Playfair Display', serif;
      font-size: 2rem;
      font-weight: 700;
      color: var(--charcoal);
      margin-bottom: var(--space-sm);
      opacity: 0;
      animation: fade-up 0.6s ease-out 0.2s forwards;
    }

    .processing-subtext {
      font-size: 1.1rem;
      color: var(--slate-500);
      height: 1.5em; /* Fixed height to prevent jumping */
      opacity: 0;
      animation: fade-up 0.6s ease-out 0.4s forwards;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       COMPONENTS
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .btn-large {
      width: 100%;
      padding: 1.25rem;
      border-radius: 20px;
      font-size: 1.1rem;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.2, 0.8, 0.2, 1);
      border: none;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      opacity: 0;
      animation: fade-up 0.8s ease-out 0.9s forwards;
      letter-spacing: 0.02em;
    }

    .btn-emerald {
      background: var(--emerald-800);
      color: white;
      box-shadow: 0 10px 30px rgba(6, 78, 59, 0.2);
    }

    .btn-emerald:hover {
      transform: translateY(-4px);
      box-shadow: 0 16px 40px rgba(6, 78, 59, 0.3);
      background: var(--emerald-900);
    }
    
    .btn-emerald:active {
      transform: scale(0.98);
    }
    
    .btn-disabled {
      background: #e2e8f0;
      color: #94a3b8;
      cursor: not-allowed;
      box-shadow: none;
    }

    @keyframes fade-up {
      from { opacity: 0; transform: translateY(30px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    /* Responsive Adjustments */
    @media (min-height: 800px) {
      .hero-image-container { height: 60%; }
    }
  </style>
</head>
<body>

  <div class="onboarding-container">
    
    <!-- Screen 1: Welcome -->
    <div class="screen active" id="screen1">
      <div class="hero-image-container">
        <img src="assets/images/Burrito_Bowl_Supreme.jpg" alt="Healthy Buddha Bowl" class="hero-image">
        <div style="position: absolute; inset: 0; background: linear-gradient(to bottom, rgba(0,0,0,0) 60%, rgba(0,0,0,0.4) 100%);"></div>
      </div>
      <div class="screen-1-content">
        <span class="brand-pill">Welcome to Flean</span>
        <h1 class="main-heading">Eat Clean.<br>Live Fit.</h1>
        <p class="sub-heading">Experience the future of grocery.<br>Zero preservatives. 100% transparency.</p>
        <button class="btn-large btn-emerald" onclick="nextScreen('trust')">
          Start Journey
        </button>
      </div>
    </div>
    
    <!-- Screen 1.5: Trust (New) -->
    <div class="screen" id="screenTrust">
      <div class="screen-trust-content">
        <div class="trust-badge-container">
          <div class="trust-shield">
            <div class="trust-number">300<span>Banned</span></div>
          </div>
        </div>
        
        <h2 class="trust-heading">
          We banned <span class="trust-highlight">300+ toxins</span> so you don't have to.
        </h2>
        
        <p class="trust-copy">
          Most "healthy" food is lying to you. We strictly exclude harmful additives, preservatives, and hidden sugars found in 90% of grocery store items.
        </p>

        <div class="banned-list">
          <span class="banned-pill">Palm Oil</span>
          <span class="banned-pill">High Fructose Corn Syrup</span>
          <span class="banned-pill">Artificial Colors</span>
          <span class="banned-pill">Carrageenan</span>
          <span class="banned-pill">Nitrates</span>
        </div>

        <button class="btn-large btn-emerald" onclick="nextScreen(2)">Continue to Personalize</button>
      </div>
    </div>
      
    <!-- Screen 2: Selector -->
    <div class="screen" id="screen2">
      <div class="screen-2-content">
        <div class="scroll-wrapper">
          <div class="selector-header">
            <h2 class="selector-heading">Curate your Clean.</h2>
            <p class="selector-sub">Select at least 3 preferences to personalize.</p>
      </div>
      
          <!-- Goals -->
          <div class="chip-section">
            <h3 class="chip-section-title">Goals</h3>
            <div class="chip-grid">
              <div class="chip" onclick="toggleChip(this)">
                <span class="chip-icon">ğŸ’ª</span> Muscle Gain <span class="chip-check">âœ“</span>
              </div>
              <div class="chip" onclick="toggleChip(this)">
                <span class="chip-icon">âš–ï¸</span> Weight Loss <span class="chip-check">âœ“</span>
              </div>
              <div class="chip" onclick="toggleChip(this)">
                <span class="chip-icon">ğŸ§˜</span> Healthy Life <span class="chip-check">âœ“</span>
              </div>
            </div>
          </div>

          <!-- Diets -->
          <div class="chip-section">
            <h3 class="chip-section-title">Dietary</h3>
            <div class="chip-grid">
              <div class="chip" onclick="toggleChip(this)">
                <span class="chip-icon">ğŸ¥‘</span> Keto <span class="chip-check">âœ“</span>
              </div>
              <div class="chip" onclick="toggleChip(this)">
                <span class="chip-icon">â°</span> Intermittent <span class="chip-check">âœ“</span>
              </div>
              <div class="chip" onclick="toggleChip(this)">
                <span class="chip-icon">ğŸŒ±</span> Vegan <span class="chip-check">âœ“</span>
              </div>
              <div class="chip" onclick="toggleChip(this)">
                <span class="chip-icon">ğŸ¥©</span> Paleo <span class="chip-check">âœ“</span>
              </div>
            </div>
          </div>

          <!-- No List -->
          <div class="chip-section">
            <h3 class="chip-section-title">The "No" List (Avoidants)</h3>
            <div class="chip-grid">
              <div class="chip" onclick="toggleChip(this)">
                <span class="chip-icon">ğŸ›¡ï¸</span> No Palm Oil <span class="chip-check">âœ“</span>
              </div>
              <div class="chip" onclick="toggleChip(this)">
                <span class="chip-icon">ğŸ¬</span> No Added Sugar <span class="chip-check">âœ“</span>
              </div>
              <div class="chip" onclick="toggleChip(this)">
                <span class="chip-icon">ğŸŒ¾</span> Gluten Free <span class="chip-check">âœ“</span>
              </div>
            </div>
          </div>
        </div>

        <div class="selector-footer">
          <div class="selection-status">
            <span>Selection</span>
            <span id="selectionCounter" class="status-count">0 / 3</span>
          </div>
          <button class="btn-large btn-disabled" id="continueBtn" onclick="nextScreen(3)" disabled style="animation: none; opacity: 1;">
            Continue
          </button>
        </div>
      </div>
    </div>

    <!-- Screen 3: Personalization -->
    <div class="screen" id="screen3">
      <div class="screen-3-content">
        
        <div class="radial-container">
          <div class="radial-circle radial-1"></div>
          <div class="radial-circle radial-2"></div>
          <div class="radial-circle radial-3"></div>
          <div class="radial-center">
            <div class="processing-logo">ğŸ¥¬</div>
          </div>
      </div>
      
        <h2 class="processing-text">Curating your aisle...</h2>
        <p class="processing-subtext" id="filteringText">Analyzing 50,000+ products.</p>
      </div>
    </div>

  </div>

  <script>
    let selectedCount = 0;
    const minSelection = 3;

    function nextScreen(screenNumber) {
      if (screenNumber === 'trust') {
        // 1 -> Trust Screen
        document.getElementById('screen1').classList.add('exit');
        document.getElementById('screen1').classList.remove('active');
        
        setTimeout(() => {
          document.getElementById('screenTrust').classList.add('active');
        }, 400);

      } else if (screenNumber === 2) {
        // Trust Screen -> 2
        document.getElementById('screenTrust').classList.add('exit');
        document.getElementById('screenTrust').classList.remove('active');
        
        setTimeout(() => {
          document.getElementById('screen2').classList.add('active');
          // Stagger chips animation
          const chips = document.querySelectorAll('.chip');
          chips.forEach((chip, i) => {
            chip.style.opacity = '0';
            chip.style.transform = 'translateY(10px)';
            setTimeout(() => {
              chip.style.transition = 'all 0.4s ease';
              chip.style.opacity = '1';
              chip.style.transform = 'translateY(0)';
            }, 100 + (i * 50));
          });
        }, 400);

      } else if (screenNumber === 3) {
        // 2 -> 3
        document.getElementById('screen2').classList.add('exit');
        document.getElementById('screen2').classList.remove('active');
        
        setTimeout(() => {
          document.getElementById('screen3').classList.add('active');
          startProcessing();
        }, 400);
      }
    }

    function toggleChip(chip) {
      chip.classList.toggle('selected');
      
      // Update count
      const allSelected = document.querySelectorAll('.chip.selected');
      selectedCount = allSelected.length;
      
      updateSelectionUI();
      
      // Haptic feedback if available
      if (navigator.vibrate) navigator.vibrate(10);
    }

    function updateSelectionUI() {
      const counter = document.getElementById('selectionCounter');
      const btn = document.getElementById('continueBtn');
      
      counter.textContent = `${selectedCount} / ${minSelection}+`;
      
      if (selectedCount >= minSelection) {
        counter.classList.add('active');
        btn.classList.remove('btn-disabled');
        btn.classList.add('btn-emerald');
        btn.disabled = false;
        btn.innerHTML = 'Personalize My Store â†’';
      } else {
        counter.classList.remove('active');
        btn.classList.add('btn-disabled');
        btn.classList.remove('btn-emerald');
        btn.disabled = true;
        btn.textContent = 'Continue';
      }
    }

    function startProcessing() {
      const text = document.getElementById('filteringText');
      const messages = [
        "Scanning labels for hidden nasties...",
        "Applying your 'No' list...",
        "Calculating health scores...",
        "Building your personalized store..."
      ];
      
      let i = 0;
      const interval = setInterval(() => {
        text.style.opacity = 0;
        setTimeout(() => {
          text.textContent = messages[i];
          text.style.opacity = 1;
          i++;
          if (i >= messages.length) {
            clearInterval(interval);
            setTimeout(finishOnboarding, 1500);
          }
        }, 300);
      }, 1500);
    }

    function finishOnboarding() {
      localStorage.setItem('hasCompletedOnboarding', 'true');
      window.location.href = 'index.html';
    }
  </script>
</body>
</html>
